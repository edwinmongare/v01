(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[662],{4243:function(e,r,t){Promise.resolve().then(t.bind(t,10970))},10970:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return _}});var a=t(57437),n=t(2265),o=t(48185),i=t(89733),l=t(4867),s=t(12218),c=t(49354);let d=(0,s.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function u(e){let{className:r,variant:t,...n}=e;return(0,a.jsx)("div",{className:(0,c.cn)(d({variant:t}),r),...n})}var f=t(86391),m=t(19783),g=t(27776);let h=[{accessorKey:"id",header:"Order Number"},{accessorKey:"createdAt",header:"Purchase Date",cell:e=>{let{row:r}=e;return(0,a.jsx)("span",{children:p(r.original.createdAt)})}},{accessorKey:"approvedForSale",header:"Approval Status",cell:e=>{let{row:r}=e;return(0,a.jsx)(u,{className:x(r.original.approvedForSale),variant:"outline",children:r.original.approvedForSale})}},{accessorKey:"_isPaid",header:"Paid Status",cell:e=>{let{row:r}=e;return(0,a.jsx)(u,{className:r.original._isPaid?"bg-green-400 h-6":"bg-red-400 h-6",variant:"outline",children:r.original._isPaid?"Paid":"Not Paid"})}},{accessorKey:"tabletImageDownload",header:"Download Certificate",cell:e=>{let{row:r}=e;return(0,a.jsx)(i.z,{variant:"outline",size:"icon",onClick:()=>v(r),disabled:!r.original._isPaid||"approved"!==r.original.approvedForSale,children:(0,a.jsx)(l._8t,{className:"h-4 w-4"})})}}],p=e=>{let r=new Date(e);return new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",year:"numeric"}).format(r)},x=e=>{switch(e){case"approved":return"bg-green-400 h-6";case"pending":return"bg-yellow-400 h-6";case"denied":return"bg-red-400 h-6";default:return"bg-gray-400 h-6"}},{generateCertificate:b}={generateCertificate:async(e,r)=>{try{let{firstName:t,surname:a}=r,n="".concat(t," ").concat(a),o="".concat("http://localhost:3000","/certificate/certificate.pdf");console.log(o,"template path");let i=await fetch(o).then(e=>{if(!e.ok)throw Error("Failed to fetch PDF. Status: ".concat(e.status));return e.arrayBuffer()}),l=await f.PDFDocument.load(i),s=l.getPages()[0],c=await l.embedFont(f.StandardFonts.CourierOblique),{width:d,height:u}=s.getSize();s.setFont(c),s.drawText(n,{x:300,y:240,size:20,color:(0,f.rgb)(0,0,0)}),s.drawText("".concat(e.state),{x:300,y:180,size:20,color:(0,f.rgb)(0,0,0)});let g=new Date,h=(g.getDate()%100).toString(),p=g.toLocaleString("en-US",{month:"long"}),x=String(g.getFullYear()).slice(-2);s.drawText("".concat(h),{x:190,y:132,size:15,color:(0,f.rgb)(0,0,0)}),s.drawText("".concat(p),{x:293,y:132,size:15,color:(0,f.rgb)(0,0,0)}),s.drawText("".concat(x),{x:413,y:132,size:15,color:(0,f.rgb)(0,0,0)}),s.drawText("".concat(e.issuingOfficer),{x:100,y:85,size:15,color:(0,f.rgb)(0,0,0)});let b=await fetch("".concat("http://localhost:3000","/stamp/signature.png")).then(e=>{if(!e.ok)throw Error("Failed to fetch image. Status: ".concat(e.status));return e.arrayBuffer()}),v=await l.embedPng(b),y=v.scale(.2);s.drawImage(v,{x:560,y:85,width:y.width,height:y.height});let w=await m.toDataURL(e.id),j=await fetch(w).then(e=>e.arrayBuffer()),N=await l.embedPng(j),S=N.scale(.7);s.drawImage(N,{x:d-S.width-10,y:u-S.height-10,width:S.width,height:S.height});let R=await l.save(),C=new Blob([R],{type:"application/pdf"}),F=document.createElement("a");return F.href=URL.createObjectURL(C),F.download="".concat(n," Certificate of Indigeneship.pdf"),F.click(),console.log("Modified PDF saved successfully"),C}catch(e){return console.error("Error modifying PDF:",e),null}finally{}}},v=async e=>{let{original:r}=e;if("approved"===r.approvedForSale&&!0===r._isPaid){let e={name:"".concat(r.firstName," ").concat(r.surname),state:r.localGovernment,issuingOfficer:r.issuingOfficer,stamp:r.stamp,id:r.id};await b(e,r),g.A.success("Downloaded")}else g.A.error("cant download"),console.log("Item is not eligible for download.")};var y=t(33514),w=t(54175);let j=n.forwardRef((e,r)=>{let{className:t,...n}=e;return(0,a.jsx)("div",{className:"relative w-full overflow-auto",children:(0,a.jsx)("table",{ref:r,className:(0,c.cn)("w-full caption-bottom text-sm",t),...n})})});j.displayName="Table";let N=n.forwardRef((e,r)=>{let{className:t,...n}=e;return(0,a.jsx)("thead",{ref:r,className:(0,c.cn)("[&_tr]:border-b",t),...n})});N.displayName="TableHeader";let S=n.forwardRef((e,r)=>{let{className:t,...n}=e;return(0,a.jsx)("tbody",{ref:r,className:(0,c.cn)("[&_tr:last-child]:border-0",t),...n})});S.displayName="TableBody",n.forwardRef((e,r)=>{let{className:t,...n}=e;return(0,a.jsx)("tfoot",{ref:r,className:(0,c.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",t),...n})}).displayName="TableFooter";let R=n.forwardRef((e,r)=>{let{className:t,...n}=e;return(0,a.jsx)("tr",{ref:r,className:(0,c.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",t),...n})});R.displayName="TableRow";let C=n.forwardRef((e,r)=>{let{className:t,...n}=e;return(0,a.jsx)("th",{ref:r,className:(0,c.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",t),...n})});C.displayName="TableHead";let F=n.forwardRef((e,r)=>{let{className:t,...n}=e;return(0,a.jsx)("td",{ref:r,className:(0,c.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",t),...n})});function P(e){var r;let{columns:t,data:n}=e,o=(0,y.b7)({data:n,columns:t,getCoreRowModel:(0,w.sC)()});return(0,a.jsx)("div",{className:"rounded-none",children:(0,a.jsxs)(j,{children:[(0,a.jsx)(N,{children:o.getHeaderGroups().map(e=>(0,a.jsx)(R,{children:e.headers.map(e=>(0,a.jsx)(C,{children:e.isPlaceholder?null:(0,y.ie)(e.column.columnDef.header,e.getContext())},e.id))},e.id))}),(0,a.jsx)(S,{children:(null===(r=o.getRowModel().rows)||void 0===r?void 0:r.length)?o.getRowModel().rows.map(e=>(0,a.jsx)(R,{"data-state":e.getIsSelected()&&"selected",children:e.getVisibleCells().map(e=>(0,a.jsx)(F,{children:(0,y.ie)(e.column.columnDef.cell,e.getContext())},e.id))},e.id)):(0,a.jsx)(R,{children:(0,a.jsx)(F,{colSpan:t.length,className:"h-24 text-center",children:"No results."})})})]})})}function D(e){let{className:r,...t}=e;return(0,a.jsx)("div",{className:(0,c.cn)("animate-pulse rounded-md bg-muted",r),...t})}async function T(){try{let e=await fetch("".concat("http://localhost:3000","/api/orders"));return(await e.json()).docs.map(e=>{var r,t;return{id:e.id,createdAt:e.createdAt,_isPaid:e._isPaid,approvedForSale:e.approvedForSale,firstName:e.firstName,localGovernment:e.localGovernment,surname:e.surname,issuingOfficer:(null===(t=e.issuingOfficer)||void 0===t?void 0:null===(r=t[0])||void 0===r?void 0:r.issuingOfficer)||""}})}catch(e){throw console.error(e),e}}function _(){let[e,r]=(0,n.useState)(null),[t,i]=(0,n.useState)(!0);(0,n.useEffect)(()=>{(async()=>{try{let e=await T();r(e)}catch(e){console.error("Error fetching data:",e)}finally{i(!1)}})()},[]);let l=(null==e?void 0:e.length)||10;return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("div",{className:"container relative flex pt-10 flex-col items-center justify-center lg:px-0",children:(0,a.jsx)("div",{className:"mx-auto flex  flex-col justify-center space-y-5 sm:w-[1050px] max-w-6xl",children:(0,a.jsxs)(o.Zb,{className:"shadow-lg",children:[(0,a.jsxs)(o.Ol,{children:[(0,a.jsx)(o.ll,{children:"Your Orders"}),(0,a.jsx)(o.SZ,{children:"Download your certificate from here"})]}),(0,a.jsxs)(o.aY,{children:[t&&(0,a.jsx)("div",{className:"flex items-center space-x-4",children:(0,a.jsx)("div",{className:"space-y-2",children:[...Array(l)].map((e,r)=>(0,a.jsx)(D,{className:"mx-auto justify-center space-y-5 w-[1000px] h-8"},r))})}),e&&!t&&(0,a.jsx)(P,{columns:h,data:e})]})]})})})})}F.displayName="TableCell",n.forwardRef((e,r)=>{let{className:t,...n}=e;return(0,a.jsx)("caption",{ref:r,className:(0,c.cn)("mt-4 text-sm text-muted-foreground",t),...n})}).displayName="TableCaption"},89733:function(e,r,t){"use strict";t.d(r,{d:function(){return s},z:function(){return c}});var a=t(57437),n=t(2265),o=t(71538),i=t(12218),l=t(49354);let s=(0,i.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=n.forwardRef((e,r)=>{let{className:t,variant:n,size:i,asChild:c=!1,...d}=e,u=c?o.g7:"button";return(0,a.jsx)(u,{className:(0,l.cn)(s({variant:n,size:i,className:t})),ref:r,...d})});c.displayName="Button"},48185:function(e,r,t){"use strict";t.d(r,{Ol:function(){return l},SZ:function(){return c},Zb:function(){return i},aY:function(){return d},ll:function(){return s}});var a=t(57437),n=t(2265),o=t(49354);let i=n.forwardRef((e,r)=>{let{className:t,...n}=e;return(0,a.jsx)("div",{ref:r,className:(0,o.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...n})});i.displayName="Card";let l=n.forwardRef((e,r)=>{let{className:t,...n}=e;return(0,a.jsx)("div",{ref:r,className:(0,o.cn)("flex flex-col space-y-1.5 p-6",t),...n})});l.displayName="CardHeader";let s=n.forwardRef((e,r)=>{let{className:t,...n}=e;return(0,a.jsx)("h3",{ref:r,className:(0,o.cn)("text-2xl font-semibold leading-none tracking-tight",t),...n})});s.displayName="CardTitle";let c=n.forwardRef((e,r)=>{let{className:t,...n}=e;return(0,a.jsx)("p",{ref:r,className:(0,o.cn)("text-sm text-muted-foreground",t),...n})});c.displayName="CardDescription";let d=n.forwardRef((e,r)=>{let{className:t,...n}=e;return(0,a.jsx)("div",{ref:r,className:(0,o.cn)("p-6 pt-0",t),...n})});d.displayName="CardContent",n.forwardRef((e,r)=>{let{className:t,...n}=e;return(0,a.jsx)("div",{ref:r,className:(0,o.cn)("flex items-center p-6 pt-0",t),...n})}).displayName="CardFooter"},49354:function(e,r,t){"use strict";t.d(r,{cn:function(){return o}});var a=t(44839),n=t(96164);function o(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return(0,n.m6)((0,a.W)(r))}}},function(e){e.O(0,[310,868,776,274,971,23,744],function(){return e(e.s=4243)}),_N_E=e.O()}]);